# 番茄钟统计功能

## 功能概述

Floato 现在支持可视化的番茄钟统计功能，可以帮助用户跟踪和分析番茄钟的使用情况。

## 功能特点

### 1. 自动统计记录
- 每当完成一个番茄钟时，系统会自动记录到统计数据中
- 数据按日期存储，支持历史记录查看
- 统计数据持久化保存在 UserDefaults 中

### 2. 统计视图
- **今日统计**: 显示今天完成的番茄钟数量
- **本周统计**: 显示最近7天的番茄钟总数
- **本月统计**: 显示最近30天的番茄钟总数
- **总计统计**: 显示所有时间的番茄钟总数

### 3. 热力图可视化
- 类似 GitHub 贡献图的热力图展示
- 显示最近365天的番茄钟活动
- 颜色深浅代表当日完成的番茄钟数量
- 包含图例说明

### 4. 访问方式
- 在菜单栏的设置界面中点击"查看统计"按钮
- 统计窗口以模态窗口形式显示
- 窗口尺寸：600x400 像素

## 技术实现

### 核心组件

1. **StatisticsStore**: 统计数据模型
   - 负责数据的存储和读取
   - 提供统计摘要和热力图数据
   - 支持按日期记录和查询

2. **StatisticsView**: 统计界面
   - 显示统计卡片和热力图
   - 响应式布局设计
   - 支持模态展示

3. **HeatmapGridView**: 热力图组件
   - 自定义实现的简单热力图
   - 52周 x 7天的网格布局
   - 颜色深浅表示活动强度

### 数据集成

- 统计数据通过 `TodoStore.statisticsStore` 访问
- 在 `markCurrentPomoDone()` 方法中自动记录
- 使用 JSON 格式存储到 UserDefaults

## 未来扩展

### ContributionChart 集成
目前使用简单的网格视图实现热力图，未来可以通过 SPM 添加 ContributionChart 依赖来获得更丰富的可视化效果：

```swift
// 添加 SPM 依赖后的代码示例
import ContributionChart

ContributionChart(data: todoStore.statisticsStore.getHeatmapData(),
                  color: .green,
                  levels: 5)
    .frame(height: 120)
```

### 可能的增强功能
- [ ] 按任务类别分类统计
- [ ] 周/月/年的统计趋势图
- [ ] 导出统计数据功能
- [ ] 设置统计目标和提醒
- [ ] 更丰富的图表样式选择

## 使用说明

1. 正常使用番茄钟完成任务
2. 每完成一个番茄钟，系统会自动记录
3. 在菜单栏设置中点击"查看统计"查看数据
4. 通过热力图了解自己的番茄钟使用模式
5. 利用统计数据改进工作效率

## 注意事项

- 统计数据从添加此功能后开始记录
- 数据存储在本地，不会上传到任何服务器
- 重装应用会清除统计数据
- 统计精度为天，同一天的多个番茄钟会累计计算